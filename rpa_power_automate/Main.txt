Folder.GetFiles Folder: PATH_DEF_DOWNLOAD_FOLDER FileFilter: $'''*''' IncludeSubfolders: False FailOnAccessDenied: True SortBy1: Folder.SortBy.NoSort SortDescending1: False SortBy2: Folder.SortBy.NoSort SortDescending2: False SortBy3: Folder.SortBy.NoSort SortDescending3: False Files=> FILES_TRASH
File.Move Files: FILES_TRASH Destination: $'''%PATH_DEF_DOWNLOAD_FOLDER%\\backup''' IfFileExists: File.IfExists.Overwrite MovedFiles=> FILES_BACKUP
DISABLE System.RunApplication.RunApplication ApplicationPath: PATH_DEF_OUTLOOK WindowStyle: System.ProcessWindowStyle.Normal ProcessId=> AppProcessId
DISABLE WAIT 1
DISABLE Outlook.Launch Instance=> OutlookInstance
**REGION LAST EOM DAY
DateTime.GetCurrentDateTime.Local DateTimeFormat: DateTime.DateTimeFormat.DateAndTime CurrentDateTime=> CurrentDateTime
DateTime.Add DateTime: CurrentDateTime TimeToAdd: $'''-%CurrentDateTime.Day%''' TimeUnit: DateTime.TimeUnit.Days ResultedDate=> ResultedDate
SET LAST_EOM_DAY TO ResultedDate.Day
Text.ConvertDateTimeToText.FromCustomDateTime DateTime: CurrentDateTime CustomFormat: $'''dd/MM/yyyy''' Result=> FormattedDateTime
**ENDREGION
**REGION INCOME DATE PARAM
SET START_DATE TO $'''%ResultedDate.Year%-%ResultedDate.Month%-01'''
SET END_DATE TO $'''%ResultedDate.Year%-%ResultedDate.Month%-%ResultedDate.Day%'''
**ENDREGION
DISABLE EXIT Code: 0
File.ReadFromCSVFile.ReadCSV CSVFile: PATH_ACC Encoding: File.CSVEncoding.UTF8 TrimFields: True FirstLineContainsColumnNames: True ColumnsSeparator: File.CSVColumnsSeparator.SystemDefault CSVTable=> ACCOUNTS
LOOP FOREACH ACC IN ACCOUNTS
    WebAutomation.LaunchChrome.LaunchChrome Url: $'''about:blank''' WindowState: WebAutomation.BrowserWindowState.Maximized ClearCache: False ClearCookies: False WaitForPageToLoadTimeout: 60 Timeout: 60 BrowserInstance=> Browser
    WebAutomation.GoToWebPage.GoToWebPage BrowserInstance: Browser Url: $'''https://shopee.co.id/seller/login''' WaitForPageToLoadTimeout: 60
    WAIT (WebAutomation.WaitForWebPageContent.WebPageToContainText BrowserInstance: Browser Text: $'''Jadilah Penjual Terbaik!''') FOR 5 
    ON ERROR

    END
    WAIT 1
    DISABLE IF (WebAutomation.IfWebPageContains.WebPageContainsElement BrowserInstance: Browser Control: appmask['Web Page \'https://seller.shopee.co.id/\'']['Unordered list  ...  Bantuan Penjual\'']) THEN
        DISABLE CALL LOGOUT
    DISABLE END
    CALL LOGIN
    CALL ORDER
    CALL INCOME
    CALL WALLET
    CALL LOGOUT
    WebAutomation.CloseWebBrowser BrowserInstance: Browser
END
EXIT Code: 0
@@copilotGeneratedAction: 'False'
DISABLE Scripting.RunPowershellScript.RunPowershellScript Script: $'''python c:/coding/enablr/power_automate/production/sp_metrics_main.py''' ScriptOutput=> MAIN_METRICS_OUTPUT ScriptError=> MAIN_METRICS_ERROR
DISABLE Outlook.SendEmailThroughOutlook.SendEmail Instance: OutlookInstance Account: $'''sulaimandra@enablr.id''' SendTo: $'''sulaimandra@enablr.id''' Subject: $'''Output Metrics Shopee''' Body: $'''Script Status for Shopee %CurrentDateTime.Year%-%CurrentDateTime.Month%-%CurrentDateTime.Day%

Output:
%MAIN_METRICS_OUTPUT%



Error:
%MAIN_METRICS_ERROR%''' IsBodyHtml: False IsDraft: False
DISABLE Variables.CreateNewDatatable InputTable: { ^['path_file', 'path_backup'], [$'''C:\\Users\\sulai\\Downloads\\power_automate\\platform\\shopee\\ads''', $'''C:\\Users\\sulai\\Downloads\\power_automate\\backup_shopee'''], [$'''C:\\Users\\sulai\\Downloads\\power_automate\\platform\\shopee\\voucher''', $'''C:\\Users\\sulai\\Downloads\\power_automate\\backup_shopee'''], [$'''C:\\Users\\sulai\\Downloads\\power_automate\\platform\\shopee\\product''', $'''C:\\Users\\sulai\\Downloads\\power_automate\\backup_shopee'''], [$'''C:\\Users\\sulai\\Downloads\\power_automate\\platform\\shopee\\store''', $'''C:\\Users\\sulai\\Downloads\\power_automate\\backup_shopee'''] } DataTable=> DataTable
DISABLE LOOP FOREACH D_FILE IN DataTable
    DISABLE Folder.GetFiles Folder: D_FILE['path_file'] FileFilter: $'''*''' IncludeSubfolders: False FailOnAccessDenied: True SortBy1: Folder.SortBy.NoSort SortDescending1: False SortBy2: Folder.SortBy.NoSort SortDescending2: False SortBy3: Folder.SortBy.NoSort SortDescending3: False Files=> Files
    DISABLE File.Move Files: Files Destination: D_FILE['path_backup'] IfFileExists: File.IfExists.Overwrite MovedFiles=> MovedFiles
DISABLE END
DISABLE Outlook.Close Instance: OutlookInstance
ON ERROR

END

# [ControlRepository][PowerAutomateDesktop]

{
  "ControlRepositorySymbols": [
    {
      "IgnoreImagesOnSerialization": false,
      "Repository": "{\r\n  \"Screens\": [\r\n    {\r\n      \"Controls\": [\r\n        {\r\n          \"AutomationProtocol\": \"uia3\",\r\n          \"ScreenShot\": null,\r\n          \"ElementTypeName\": \"Unordered list\",\r\n          \"InstanceId\": \"6bdf569e-8c9a-478f-a176-000b846ed05f\",\r\n          \"Name\": \"Unordered list  ...  Bantuan Penjual'\",\r\n          \"SelectorCount\": 1,\r\n          \"Selectors\": [\r\n            {\r\n              \"CustomSelector\": null,\r\n              \"Elements\": [\r\n                {\r\n                  \"Attributes\": [\r\n                    {\r\n                      \"Ignore\": true,\r\n                      \"IsOrdinal\": false,\r\n                      \"Name\": \"Class\",\r\n                      \"Operation\": \"EqualTo\",\r\n                      \"Value\": \" route-index\"\r\n                    },\r\n                    {\r\n                      \"Ignore\": true,\r\n                      \"IsOrdinal\": false,\r\n                      \"Name\": \"Id\",\r\n                      \"Operation\": \"EqualTo\",\r\n                      \"Value\": null\r\n                    },\r\n                    {\r\n                      \"Ignore\": true,\r\n                      \"IsOrdinal\": true,\r\n                      \"Name\": \"Ordinal\",\r\n                      \"Operation\": \"EqualTo\",\r\n                      \"Value\": 0\r\n                    },\r\n                    {\r\n                      \"Ignore\": true,\r\n                      \"IsOrdinal\": false,\r\n                      \"Name\": \"Title\",\r\n                      \"Operation\": \"EqualTo\",\r\n                      \"Value\": null\r\n                    }\r\n                  ],\r\n                  \"CustomValue\": null,\r\n                  \"Ignore\": true,\r\n                  \"Name\": \"Body 'Seller Centrecrayola.official Sistem Sub AkunProfil  ... nceMMFStartTime = Date.now();mmmmmmmmmmlli'\",\r\n                  \"Tag\": \"body\"\r\n                },\r\n                {\r\n                  \"Attributes\": [\r\n                    {\r\n                      \"Ignore\": true,\r\n                      \"IsOrdinal\": false,\r\n                      \"Name\": \"Class\",\r\n                      \"Operation\": \"EqualTo\",\r\n                      \"Value\": null\r\n                    },\r\n                    {\r\n                      \"Ignore\": false,\r\n                      \"IsOrdinal\": false,\r\n                      \"Name\": \"Id\",\r\n                      \"Operation\": \"EqualTo\",\r\n                      \"Value\": \"app\"\r\n                    },\r\n                    {\r\n                      \"Ignore\": true,\r\n                      \"IsOrdinal\": true,\r\n                      \"Name\": \"Ordinal\",\r\n                      \"Operation\": \"EqualTo\",\r\n                      \"Value\": 0\r\n                    },\r\n                    {\r\n                      \"Ignore\": true,\r\n                      \"IsOrdinal\": false,\r\n                      \"Name\": \"Title\",\r\n                      \"Operation\": \"EqualTo\",\r\n                      \"Value\": null\r\n                    }\r\n                  ],\r\n                  \"CustomValue\": null,\r\n                  \"Ignore\": true,\r\n                  \"Name\": \"Div 'Seller Centrecrayola.official Sistem Sub AkunProfil  ...  2 slot tambahan di fitur Naikkan Produk Mulai Saran'\",\r\n                  \"Tag\": \"div\"\r\n                },\r\n                {\r\n                  \"Attributes\": [\r\n                    {\r\n                      \"Ignore\": true,\r\n                      \"IsOrdinal\": false,\r\n                      \"Name\": \"Class\",\r\n                      \"Operation\": \"EqualTo\",\r\n                      \"Value\": \"app-container\"\r\n                    },\r\n                    {\r\n                      \"Ignore\": true,\r\n                      \"IsOrdinal\": false,\r\n                      \"Name\": \"Id\",\r\n                      \"Operation\": \"EqualTo\",\r\n                      \"Value\": null\r\n                    },\r\n                    {\r\n                      \"Ignore\": true,\r\n                      \"IsOrdinal\": true,\r\n                      \"Name\": \"Ordinal\",\r\n                      \"Operation\": \"EqualTo\",\r\n                      \"Value\": 0\r\n                    },\r\n                    {\r\n                      \"Ignore\": true,\r\n                      \"IsOrdinal\": false,\r\n                      \"Name\": \"Title\",\r\n                      \"Operation\": \"EqualTo\",\r\n                      \"Value\": null\r\n                    }\r\n                  ],\r\n                  \"CustomValue\": null,\r\n                  \"Ignore\": true,\r\n                  \"Name\": \"Div 'Pengiriman Menu baru! Kini, pengaturan pengiriman  ...  2 slot tambahan di fitur Naikkan Produk Mulai'\",\r\n                  \"Tag\": \"div\"\r\n                },\r\n                {\r\n                  \"Attributes\": [\r\n                    {\r\n                      \"Ignore\": true,\r\n                      \"IsOrdinal\": false,\r\n                      \"Name\": \"Class\",\r\n                      \"Operation\": \"EqualTo\",\r\n                      \"Value\": \"sidebar-container\"\r\n                    },\r\n                    {\r\n                      \"Ignore\": false,\r\n                      \"IsOrdinal\": false,\r\n                      \"Name\": \"Id\",\r\n                      \"Operation\": \"EqualTo\",\r\n                      \"Value\": \"sidebar-container\"\r\n                    },\r\n                    {\r\n                      \"Ignore\": true,\r\n                      \"IsOrdinal\": true,\r\n                      \"Name\": \"Ordinal\",\r\n                      \"Operation\": \"EqualTo\",\r\n                      \"Value\": 0\r\n                    },\r\n                    {\r\n                      \"Ignore\": true,\r\n                      \"IsOrdinal\": false,\r\n                      \"Name\": \"Title\",\r\n                      \"Operation\": \"EqualTo\",\r\n                      \"Value\": null\r\n                    }\r\n                  ],\r\n                  \"CustomValue\": null,\r\n                  \"Ignore\": false,\r\n                  \"Name\": \"Div 'Pengiriman Menu baru! Kini, pengaturan pengiriman  ...  PartnerKeamanan TokoBantuanPusat Bantuan Penjual'\",\r\n                  \"Tag\": \"div\"\r\n                },\r\n                {\r\n                  \"Attributes\": [\r\n                    {\r\n                      \"Ignore\": true,\r\n                      \"IsOrdinal\": false,\r\n                      \"Name\": \"Class\",\r\n                      \"Operation\": \"EqualTo\",\r\n                      \"Value\": \"sidebar\"\r\n                    },\r\n                    {\r\n                      \"Ignore\": true,\r\n                      \"IsOrdinal\": false,\r\n                      \"Name\": \"Id\",\r\n                      \"Operation\": \"EqualTo\",\r\n                      \"Value\": null\r\n                    },\r\n                    {\r\n                      \"Ignore\": true,\r\n                      \"IsOrdinal\": true,\r\n                      \"Name\": \"Ordinal\",\r\n                      \"Operation\": \"EqualTo\",\r\n                      \"Value\": 0\r\n                    },\r\n                    {\r\n                      \"Ignore\": true,\r\n                      \"IsOrdinal\": false,\r\n                      \"Name\": \"Title\",\r\n                      \"Operation\": \"EqualTo\",\r\n                      \"Value\": null\r\n                    }\r\n                  ],\r\n                  \"CustomValue\": null,\r\n                  \"Ignore\": false,\r\n                  \"Name\": \"Div 'Pengiriman Menu baru! Kini, pengaturan pengiriman  ...  PartnerKeamanan TokoBantuanPusat Bantuan Penjual'\",\r\n                  \"Tag\": \"div\"\r\n                },\r\n                {\r\n                  \"Attributes\": [\r\n                    {\r\n                      \"Ignore\": true,\r\n                      \"IsOrdinal\": false,\r\n                      \"Name\": \"Class\",\r\n                      \"Operation\": \"EqualTo\",\r\n                      \"Value\": \"sidebar-menu\"\r\n                    },\r\n                    {\r\n                      \"Ignore\": true,\r\n                      \"IsOrdinal\": false,\r\n                      \"Name\": \"Id\",\r\n                      \"Operation\": \"EqualTo\",\r\n                      \"Value\": null\r\n                    },\r\n                    {\r\n                      \"Ignore\": true,\r\n                      \"IsOrdinal\": true,\r\n                      \"Name\": \"Ordinal\",\r\n                      \"Operation\": \"EqualTo\",\r\n                      \"Value\": 0\r\n                    },\r\n                    {\r\n                      \"Ignore\": true,\r\n                      \"IsOrdinal\": false,\r\n                      \"Name\": \"Title\",\r\n                      \"Operation\": \"EqualTo\",\r\n                      \"Value\": null\r\n                    },\r\n                    {\r\n                      \"Ignore\": true,\r\n                      \"IsOrdinal\": false,\r\n                      \"Name\": \"Type\",\r\n                      \"Operation\": \"EqualTo\",\r\n                      \"Value\": null\r\n                    }\r\n                  ],\r\n                  \"CustomValue\": null,\r\n                  \"Ignore\": false,\r\n                  \"Name\": \"Unordered list 'Pengiriman Menu baru! Kini, pengaturan pengiriman  ...  PartnerKeamanan TokoBantuanPusat Bantuan Penjual'\",\r\n                  \"Tag\": \"ul\"\r\n                }\r\n              ],\r\n              \"Ignore\": false,\r\n              \"ImageSelector\": null,\r\n              \"IsCustom\": false,\r\n              \"IsImageBased\": false,\r\n              \"IsWindowsInstance\": false,\r\n              \"Name\": \"Default Selector\",\r\n              \"Properties\": []\r\n            }\r\n          ],\r\n          \"Tag\": \"ul\",\r\n          \"ScreenshotPath\": \"controlRepo-screenshots\\\\f25cd40b-cb06-44f7-9261-e12aba8bcfb8.png\"\r\n        }\r\n      ],\r\n      \"Handle\": {\r\n        \"value\": 0\r\n      },\r\n      \"ProcessName\": null,\r\n      \"ScreenShot\": null,\r\n      \"ElementTypeName\": \"Web Page\",\r\n      \"InstanceId\": \"193e05a4-c97c-4865-babe-90de9461d5e8\",\r\n      \"Name\": \"Web Page 'https://seller.shopee.co.id/'\",\r\n      \"SelectorCount\": 1,\r\n      \"Selectors\": [\r\n        {\r\n          \"CustomSelector\": null,\r\n          \"Elements\": [\r\n            {\r\n              \"Attributes\": [],\r\n              \"CustomValue\": \"domcontainer\",\r\n              \"Ignore\": false,\r\n              \"Name\": \"Web Page 'https://seller.shopee.co.id/'\",\r\n              \"Tag\": \"domcontainer\"\r\n            }\r\n          ],\r\n          \"Ignore\": false,\r\n          \"ImageSelector\": null,\r\n          \"IsCustom\": false,\r\n          \"IsImageBased\": false,\r\n          \"IsWindowsInstance\": false,\r\n          \"Name\": \"Default Selector\",\r\n          \"Properties\": []\r\n        }\r\n      ],\r\n      \"Tag\": \"domcontainer\",\r\n      \"ScreenshotPath\": \"controlRepo-screenshots\\\\e837d662-94eb-41d5-8b3d-4b91fc4fae03.png\"\r\n    }\r\n  ],\r\n  \"Version\": 1\r\n}",
      "ImportMetadata": {
        "DisplayName": "Local computer",
        "ConnectionString": "",
        "Type": "Local",
        "DesktopType": "local"
      },
      "Name": "appmask"
    }
  ],
  "ImageRepositorySymbol": {
    "Repository": "{\r\n  \"Folders\": [],\r\n  \"Images\": [],\r\n  \"Version\": 1\r\n}",
    "ImportMetadata": {},
    "Name": "imgrepo"
  },
  "ConnectionReferences": []
}
